import{c as s,r as u,w as j,k as I,h as o,Z as O,$ as P}from"./index.2309271c.js";import{e as $}from"./QBtn.961aa16e.js";import{c as A}from"./create.22a8c9b7.js";import{h as Q}from"./render.69441bda.js";const D={ratio:[String,Number]};function L(e,t){return s(()=>{const n=Number(e.ratio||(t!==void 0?t.value:void 0));return isNaN(n)!==!0&&n>0?{paddingBottom:`${100/n}%`}:null})}const M=16/9;var Z=A({name:"QImg",props:{...D,src:String,srcset:String,sizes:String,alt:String,crossorigin:String,decoding:String,referrerpolicy:String,draggable:Boolean,loading:{type:String,default:"lazy"},fetchpriority:{type:String,default:"auto"},width:String,height:String,initialRatio:{type:[Number,String],default:M},placeholderSrc:String,fit:{type:String,default:"cover"},position:{type:String,default:"50% 50%"},imgClass:String,imgStyle:Object,noSpinner:Boolean,noNativeMenu:Boolean,noTransition:Boolean,spinnerColor:String,spinnerSize:String},emits:["load","error"],setup(e,{slots:t,emit:n}){const h=u(e.initialRatio),S=L(e,h);let l;const r=[u(null),u(m())],a=u(0),c=u(!1),d=u(!1),_=s(()=>`q-img q-img--${e.noNativeMenu===!0?"no-":""}menu`),q=s(()=>({width:e.width,height:e.height})),C=s(()=>`q-img__image ${e.imgClass!==void 0?e.imgClass+" ":""}q-img__image--with${e.noTransition===!0?"out":""}-transition`),z=s(()=>({...e.imgStyle,objectFit:e.fit,objectPosition:e.position}));j(()=>y(),b);function y(){return e.src||e.srcset||e.sizes?{src:e.src,srcset:e.srcset,sizes:e.sizes}:null}function m(){return e.placeholderSrc!==void 0?{src:e.placeholderSrc}:null}function b(i){clearTimeout(l),d.value=!1,i===null?(c.value=!1,r[a.value^1].value=m()):c.value=!0,r[a.value].value=i}function R({target:i}){l!==null&&(clearTimeout(l),h.value=i.naturalHeight===0?.5:i.naturalWidth/i.naturalHeight,w(i,1))}function w(i,g){l===null||g===1e3||(i.complete===!0?T(i):l=setTimeout(()=>{w(i,g+1)},50))}function T(i){l!==null&&(a.value=a.value^1,r[a.value].value=null,c.value=!1,d.value=!1,n("load",i.currentSrc||i.src))}function B(i){clearTimeout(l),c.value=!1,d.value=!0,r[a.value].value=null,r[a.value^1].value=m(),n("error",i)}function k(i){const g=r[i].value,f={key:"img_"+i,class:C.value,style:z.value,crossorigin:e.crossorigin,decoding:e.decoding,referrerpolicy:e.referrerpolicy,height:e.height,width:e.width,loading:e.loading,fetchpriority:e.fetchpriority,"aria-hidden":"true",draggable:e.draggable,...g};return a.value===i?(f.class+=" q-img__image--waiting",Object.assign(f,{onLoad:R,onError:B})):f.class+=" q-img__image--loaded",o("div",{class:"q-img__container absolute-full",key:"img"+i},o("img",f))}function N(){return c.value!==!0?o("div",{key:"content",class:"q-img__content absolute-full q-anchor--skip"},Q(t[d.value===!0?"error":"default"])):o("div",{key:"loading",class:"q-img__loading absolute-full flex flex-center"},t.loading!==void 0?t.loading():e.noSpinner===!0?void 0:[o($,{color:e.spinnerColor,size:e.spinnerSize})])}return b(y()),I(()=>{clearTimeout(l),l=null}),()=>{const i=[];return S.value!==null&&i.push(o("div",{key:"filler",style:S.value})),d.value!==!0&&(r[0].value!==null&&i.push(k(0)),r[1].value!==null&&i.push(k(1))),i.push(o(O,{name:"q-transition--fade"},N)),o("div",{class:_.value,style:q.value,role:"img","aria-label":e.alt},i)}}});const G={dark:{type:Boolean,default:null}};function J(e,t){return s(()=>e.dark===null?t.dark.isActive:e.dark)}const v={left:!0,right:!0,up:!0,down:!0,horizontal:!0,vertical:!0},U=Object.keys(v);v.all=!0;function K(e){const t={};for(const n of U)e[n]===!0&&(t[n]=!0);return Object.keys(t).length===0?v:(t.horizontal===!0?t.left=t.right=!0:t.left===!0&&t.right===!0&&(t.horizontal=!0),t.vertical===!0?t.up=t.down=!0:t.up===!0&&t.down===!0&&(t.vertical=!0),t.horizontal===!0&&t.vertical===!0&&(t.all=!0),t)}function V(e,t){return t.event===void 0&&e.target!==void 0&&e.target.draggable!==!0&&typeof t.handler=="function"&&e.target.nodeName.toUpperCase()!=="INPUT"&&(e.qClonedBy===void 0||e.qClonedBy.indexOf(t.uid)===-1)}function X(){if(window.getSelection!==void 0){const e=window.getSelection();e.empty!==void 0?e.empty():e.removeAllRanges!==void 0&&(e.removeAllRanges(),P.is.mobile!==!0&&e.addRange(document.createRange()))}else document.selection!==void 0&&document.selection.empty()}export{Z as Q,J as a,X as c,K as g,V as s,G as u};
